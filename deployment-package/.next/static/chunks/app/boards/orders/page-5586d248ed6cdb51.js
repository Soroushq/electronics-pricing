(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[386],{2383:()=>{},3340:(e,t,a)=>{Promise.resolve().then(a.bind(a,5100))},3686:()=>{},3741:(e,t,a)=>{"use strict";a.d(t,{$n:()=>n});var s=a(5155);a(2115);var r=a(7050);let n=e=>{let{children:t,className:a,variant:n="primary",size:i="md",loading:l=!1,icon:o,iconPosition:c="right",fullWidth:d=!1,disabled:m,...x}=e,u=m||l;return(0,s.jsxs)("button",{className:(0,r.cn)("btn-base inline-flex items-center justify-center gap-2 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"btn-primary focus:ring-blue-500",secondary:"btn-secondary focus:ring-gray-500",success:"btn-success focus:ring-green-500",danger:"btn-danger focus:ring-red-500",warning:"bg-yellow-500 hover:bg-yellow-600 text-white focus:ring-yellow-500",outline:"btn-outline focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 text-gray-700 border-transparent focus:ring-gray-500"}[n],{sm:"btn-sm text-sm",md:"btn-md text-sm",lg:"btn-lg text-base",xl:"px-6 py-3 text-lg"}[i],d&&"w-full",a),disabled:u,...x,children:[l&&(0,s.jsx)("div",{className:"spinner"}),!l&&o&&"right"===c&&(0,s.jsx)("span",{className:"flex-shrink-0",children:o}),t&&(0,s.jsx)("span",{className:(0,r.cn)(l&&"opacity-0","font-persian"),children:t}),!l&&o&&"left"===c&&(0,s.jsx)("span",{className:"flex-shrink-0",children:o})]})}},5100:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var s=a(5155),r=a(2115),n=a(5695),i=a(3654),l=a(3741),o=a(7703),c=a(6226),d=a(6728);function m(){let e=(0,n.useRouter)(),{exportBoardsOrder:t}=(0,d.L)(),[a,m]=(0,r.useState)([]),[x,u]=(0,r.useState)(""),h=(e,t)=>{let s=a.find(t=>t.boardId===e.id);if(s)p(e.id,s.quantity+t);else{let a={boardId:e.id,name:e.name,quantity:t,unitCost:e.totalCost,totalCost:e.totalCost*t,parts:e.parts};m(e=>[...e,a])}},p=(e,t)=>{if(t<=0)return void f(e);m(a=>a.map(a=>a.boardId===e?{...a,quantity:t,totalCost:a.unitCost*t}:a))},f=e=>{m(t=>t.filter(t=>t.boardId!==e))},j=()=>a.reduce((e,t)=>e+t.quantity,0),g=()=>{let e=new Map;return a.forEach(t=>{t.parts.forEach(a=>{let s=a.quantity*t.quantity,r=e.get(a.partId);r?(r.totalQuantity+=s,r.totalCost=r.totalQuantity*r.unitPrice,r.usedInBoards.push("".concat(t.name," (").concat(t.quantity,"\xd7)"))):e.set(a.partId,{partId:a.partId,name:a.name,partNumber:a.partNumber,unitPrice:a.unitPrice,totalQuantity:s,totalCost:s*a.unitPrice,usedInBoards:["".concat(t.name," (").concat(t.quantity,"\xd7)")]})})}),Array.from(e.values())},b=[{id:"1",name:"برد کنترل موتور",description:"برد کنترل موتور استپر",pcbCost:5e4,assemblyCost:25e3,totalCost:87e3,parts:[{partId:"1",name:"مقاومت ۱۰کΩ",partNumber:"R-10K-01",unitPrice:500,quantity:3},{partId:"2",name:"خازن ۱۰۰μF",partNumber:"C-100UF-16V",unitPrice:2e3,quantity:2},{partId:"3",name:"IC LM358",partNumber:"IC-LM358-DIP8",unitPrice:8e3,quantity:1}]},{id:"2",name:"برد سنسور دما",description:"برد اندازه‌گیری دمای محیط",pcbCost:3e4,assemblyCost:15e3,totalCost:52500,parts:[{partId:"1",name:"مقاومت ۱۰کΩ",partNumber:"R-10K-01",unitPrice:500,quantity:2},{partId:"4",name:"ترانزیستور BC547",partNumber:"TR-BC547",unitPrice:1500,quantity:1},{partId:"5",name:"دیود 1N4007",partNumber:"D-1N4007",unitPrice:800,quantity:2}]},{id:"3",name:"برد تغذیه",description:"برد تنظیم ولتاژ ۵ ولت",pcbCost:4e4,assemblyCost:2e4,totalCost:72e3,parts:[{partId:"2",name:"خازن ۱۰۰μF",partNumber:"C-100UF-16V",unitPrice:2e3,quantity:4},{partId:"5",name:"دیود 1N4007",partNumber:"D-1N4007",unitPrice:800,quantity:4},{partId:"1",name:"مقاومت ۱۰کΩ",partNumber:"R-10K-01",unitPrice:500,quantity:1}]}].filter(e=>!x||e.name.toLowerCase().includes(x.toLowerCase())||e.description.toLowerCase().includes(x.toLowerCase())),y=g();return(0,s.jsx)(c.e,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(l.$n,{variant:"outline",onClick:()=>e.back(),className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,s.jsx)(i.Ef,{children:"بازگشت"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:(0,s.jsx)(i.Ef,{children:"سفارش برد"})}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:(0,s.jsx)(i.Ef,{children:"انتخاب برد و محاسبه قطعات مورد نیاز"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(l.$n,{variant:"secondary",onClick:()=>{if(0===a.length)return void alert("سبد خرید خالی است! ابتدا بردهایی اضافه کنید.");t(a,g())?alert("فایل اکسل با موفقیت ایجاد شد!"):alert("خطا در ایجاد فایل اکسل!")},disabled:0===a.length,className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)(i.Ef,{children:"خروجی اکسل"})]}),(0,s.jsx)(l.$n,{variant:"outline",onClick:()=>m([]),children:(0,s.jsx)(i.Ef,{children:"پاک کردن سبد"})}),(0,s.jsx)(l.$n,{variant:"primary",onClick:()=>{if(0===a.length)return void alert("لطفاً حداقل یک برد به سفارش اضافه کنید");console.log("Submitting board order:",{orderItems:a,bom:g()}),alert("سفارش ".concat(a.length," نوع برد (").concat(j()," عدد) با موفقیت ثبت شد!")),m([])},children:(0,s.jsx)(i.Ef,{children:"ثبت سفارش"})})]})]})}),(0,s.jsxs)("div",{className:"flex h-[calc(100vh-120px)]",children:[(0,s.jsxs)("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"font-semibold text-gray-900 mb-3",children:(0,s.jsx)(i.Ef,{children:"بردهای موجود"})}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("input",{type:"text",placeholder:"جستجو در بردها...",value:x,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:b.map(e=>(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 hover:shadow-sm transition-shadow",children:[(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 text-sm",children:(0,s.jsx)(i.Ef,{children:e.name})}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:(0,s.jsxs)(i.Ef,{children:[e.parts.length," نوع قطعه"]})}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,s.jsx)("span",{className:"text-xs font-semibold text-green-600",children:(0,s.jsxs)(i.Ef,{children:[e.totalCost.toLocaleString("fa-IR")," ریال"]})})}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>h(e,1),children:(0,s.jsx)(i.Ef,{children:"+۱"})}),(0,s.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>h(e,5),children:(0,s.jsx)(i.Ef,{children:"+۵"})}),(0,s.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>h(e,10),children:(0,s.jsx)(i.Ef,{children:"+۱۰"})})]})]},e.id))})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col bg-gray-50",children:(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:(0,s.jsxs)(i.Ef,{children:["سبد خرید (",a.length," نوع برد)"]})}),0===a.length?(0,s.jsxs)(o.Zp,{className:"p-6 text-center",children:[(0,s.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8L9 5l10 8"})}),(0,s.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-1",children:(0,s.jsx)(i.Ef,{children:"سبد خرید خالی است"})}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:(0,s.jsx)(i.Ef,{children:"از سایدبار سمت چپ بردهای مورد نیاز را انتخاب کنید"})})]}):(0,s.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,s.jsx)(o.Zp,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:(0,s.jsx)(i.Ef,{children:e.name})}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:(0,s.jsxs)(i.Ef,{children:["قیمت واحد: ",e.unitCost.toLocaleString("fa-IR")," ریال"]})}),(0,s.jsx)("p",{className:"text-xs text-blue-600",children:(0,s.jsxs)(i.Ef,{children:[e.parts.length," نوع قطعه"]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>p(e.boardId,e.quantity-1),children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsx)("span",{className:"w-12 text-center font-medium",children:(0,s.jsx)(i.Ef,{children:e.quantity.toLocaleString("fa-IR")})}),(0,s.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>p(e.boardId,e.quantity+1),children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),(0,s.jsx)("div",{className:"text-left w-28",children:(0,s.jsx)("p",{className:"font-semibold text-green-600",children:(0,s.jsxs)(i.Ef,{children:[e.totalCost.toLocaleString("fa-IR")," ریال"]})})}),(0,s.jsx)(l.$n,{variant:"danger",size:"sm",onClick:()=>f(e.boardId),children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.boardId))})]}),y.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:(0,s.jsx)(i.Ef,{children:"فهرست قطعات مورد نیاز (BOM)"})}),(0,s.jsx)("div",{className:"bg-yellow-50 rounded-lg p-3 mb-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-yellow-700 font-medium",children:(0,s.jsx)(i.Ef,{children:"تعداد انواع قطعات:"})}),(0,s.jsx)("p",{className:"font-bold text-yellow-800",children:(0,s.jsxs)(i.Ef,{children:[y.length.toLocaleString("fa-IR")," نوع"]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-yellow-700 font-medium",children:(0,s.jsx)(i.Ef,{children:"مجموع قطعات:"})}),(0,s.jsx)("p",{className:"font-bold text-yellow-800",children:(0,s.jsxs)(i.Ef,{children:[y.reduce((e,t)=>e+t.totalQuantity,0).toLocaleString("fa-IR")," عدد"]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-yellow-700 font-medium",children:(0,s.jsx)(i.Ef,{children:"هزینه قطعات:"})}),(0,s.jsx)("p",{className:"font-bold text-yellow-800",children:(0,s.jsxs)(i.Ef,{children:[y.reduce((e,t)=>e+t.totalCost,0).toLocaleString("fa-IR")," ریال"]})})]})]})}),(0,s.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,s.jsx)(o.Zp,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 text-sm",children:(0,s.jsx)(i.Ef,{children:e.name})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 font-mono",children:e.partNumber}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:(0,s.jsxs)(i.Ef,{children:["استفاده در: ",e.usedInBoards.join(", ")]})})]}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-600",children:(0,s.jsxs)(i.Ef,{children:[e.totalQuantity.toLocaleString("fa-IR")," عدد"]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(0,s.jsxs)(i.Ef,{children:[e.unitPrice.toLocaleString("fa-IR")," ریال/عدد"]})}),(0,s.jsx)("p",{className:"text-sm font-semibold text-green-600",children:(0,s.jsxs)(i.Ef,{children:[e.totalCost.toLocaleString("fa-IR")," ریال"]})})]})]})},e.partId))})]})]})}),(0,s.jsx)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:(0,s.jsx)(i.Ef,{children:"خلاصه سفارش"})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:(0,s.jsx)(i.Ef,{children:"تعداد انواع برد:"})}),(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsxs)(i.Ef,{children:[a.length.toLocaleString("fa-IR")," نوع"]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:(0,s.jsx)(i.Ef,{children:"مجموع بردها:"})}),(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsxs)(i.Ef,{children:[j().toLocaleString("fa-IR")," عدد"]})})]}),y.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("hr",{}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:(0,s.jsx)(i.Ef,{children:"انواع قطعات:"})}),(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsxs)(i.Ef,{children:[y.length.toLocaleString("fa-IR")," نوع"]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:(0,s.jsx)(i.Ef,{children:"مجموع قطعات:"})}),(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsxs)(i.Ef,{children:[y.reduce((e,t)=>e+t.totalQuantity,0).toLocaleString("fa-IR")," عدد"]})})]})]}),(0,s.jsx)("hr",{}),(0,s.jsx)("div",{className:"bg-green-50 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:(0,s.jsx)(i.Ef,{children:"مجموع کل:"})}),(0,s.jsx)("span",{className:"font-bold text-lg text-green-600",children:(0,s.jsxs)(i.Ef,{children:[a.reduce((e,t)=>e+t.totalCost,0).toLocaleString("fa-IR")," ریال"]})})]})}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,s.jsx)("p",{children:(0,s.jsx)(i.Ef,{children:"• شامل هزینه PCB و مونتاژ"})}),(0,s.jsx)("p",{children:(0,s.jsx)(i.Ef,{children:"• فهرست قطعات محاسبه شده"})}),(0,s.jsx)("p",{children:(0,s.jsx)(i.Ef,{children:"• هزینه حمل جداگانه"})})]})]})]})})]})]})})}},6728:(e,t,a)=>{"use strict";a.d(t,{L:()=>n});var s=a(2115),r=a(3925);let n=()=>{let e=(0,s.useCallback)((e,t)=>{try{let a=r.Wp.book_new(),s=[["گزارش سفارش الکترونیک","","",""],["","","",""],["شماره سفارش",e.summary.orderNumber,"",""],["تاریخ سفارش",e.summary.orderDate,"",""],["نام مشتری",e.summary.customerName||"نامشخص","",""],["","","",""],["خلاصه سفارش","","",""],["انواع دستگاه",e.summary.totalUniqueDevices,"مجموع دستگاه‌ها",e.summary.totalDevices],["انواع برد",e.summary.totalUniqueBoards,"مجموع بردها",e.summary.totalBoards],["انواع قطعه",e.summary.totalUniqueParts,"مجموع قطعات",e.summary.totalParts],["","","",""],["مبلغ کل (ریال)",e.summary.grandTotal.toLocaleString("fa-IR"),"",""]],n=r.Wp.aoa_to_sheet(s);if(n["!cols"]=[{width:20},{width:20},{width:20},{width:20}],r.Wp.book_append_sheet(a,n,"خلاصه سفارش"),e.devices&&e.devices.length>0){let t=e.devices.map(e=>[e.deviceCode,e.deviceName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.boardsCount,e.partsCount]),s=e.devices.reduce((e,t)=>e+t.totalPrice,0);t.push(["","مجموع کل","","",s.toLocaleString("fa-IR"),"",""]);let n=[["کد دستگاه","نام دستگاه","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","تعداد بردها","تعداد قطعات"],...t],i=r.Wp.aoa_to_sheet(n);i["!cols"]=[{width:15},{width:25},{width:10},{width:18},{width:18},{width:12},{width:12}],r.Wp.book_append_sheet(a,i,"لیست دستگاه‌ها")}if(e.boards&&e.boards.length>0){let t=e.boards.map(e=>[e.boardCode,e.boardName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.partsCount,e.usedInDevice||""]),s=e.boards.reduce((e,t)=>e+t.totalPrice,0);t.push(["","مجموع کل","","",s.toLocaleString("fa-IR"),"",""]);let n=[["کد برد","نام برد","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","تعداد قطعات","استفاده در"],...t],i=r.Wp.aoa_to_sheet(n);i["!cols"]=[{width:15},{width:25},{width:10},{width:18},{width:18},{width:12},{width:20}],r.Wp.book_append_sheet(a,i,"لیست بردها")}let i=e.parts.map(e=>[e.partCode,e.partName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.category||"",e.supplier||"",e.usedIn||""]),l=e.parts.reduce((e,t)=>e+t.totalPrice,0),o=e.parts.reduce((e,t)=>e+t.quantity,0);i.push(["","مجموع کل",o,"",l.toLocaleString("fa-IR"),"","",""]);let c=[["کد قطعه","نام قطعه","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","دسته‌بندی","تامین‌کننده","استفاده در"],...i],d=r.Wp.aoa_to_sheet(c);d["!cols"]=[{width:15},{width:30},{width:10},{width:18},{width:18},{width:15},{width:15},{width:25}],r.Wp.book_append_sheet(a,d,"لیست قطعات");let m=t||"سفارش_".concat(e.summary.orderNumber,"_").concat(new Date().toLocaleDateString("fa-IR").replace(/\//g,"-"),".xlsx");return r._h(a,m),!0}catch(e){return console.error("خطا در تولید فایل اکسل:",e),!1}},[]),t=(0,s.useCallback)((t,a)=>{let s={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:a||"P-".concat(Date.now()),totalDevices:0,totalBoards:0,totalParts:t.reduce((e,t)=>e+t.quantity,0),totalUniqueDevices:0,totalUniqueBoards:0,totalUniqueParts:t.length,grandTotal:t.reduce((e,t)=>e+t.totalPrice,0)};return e({summary:s,parts:t.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,category:e.category,usedIn:"سفارش مستقل قطعات"}))},"سفارش_قطعات_".concat(s.orderNumber,".xlsx"))},[e]),a=(0,s.useCallback)((t,a,s)=>{let r={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:s||"B-".concat(Date.now()),totalDevices:0,totalBoards:t.reduce((e,t)=>e+t.quantity,0),totalParts:a.reduce((e,t)=>e+t.totalQuantity,0),totalUniqueDevices:0,totalUniqueBoards:t.length,totalUniqueParts:a.length,grandTotal:t.reduce((e,t)=>e+t.totalCost,0)},n=t.map(e=>({boardCode:"BRD-".concat(e.boardId),boardName:e.name,quantity:e.quantity,unitPrice:e.unitCost,totalPrice:e.totalCost,partsCount:e.parts.length,usedInDevice:"سفارش مستقل برد"}));return e({summary:r,boards:n,parts:a.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.totalQuantity,unitPrice:e.unitPrice,totalPrice:e.totalCost,usedIn:e.usedInBoards.join(", ")}))},"سفارش_بردها_".concat(r.orderNumber,".xlsx"))},[e]),n=(0,s.useCallback)((t,a,s,r)=>{let n={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:r||"D-".concat(Date.now()),totalDevices:t.reduce((e,t)=>e+t.quantity,0),totalBoards:a.reduce((e,t)=>e+t.totalQuantity,0),totalParts:s.reduce((e,t)=>e+t.totalQuantity,0),totalUniqueDevices:t.length,totalUniqueBoards:a.length,totalUniqueParts:s.length,grandTotal:t.reduce((e,t)=>e+t.totalCost,0)},i=t.map(e=>({deviceCode:"DEV-".concat(e.deviceId),deviceName:e.name,quantity:e.quantity,unitPrice:e.unitCost,totalPrice:e.totalCost,boardsCount:e.boards.length,partsCount:e.boards.reduce((e,t)=>e+t.parts.length,0)})),l=a.map(e=>({boardCode:"BRD-".concat(e.boardId),boardName:e.name,quantity:e.totalQuantity,unitPrice:e.unitCost,totalPrice:e.totalCost,partsCount:0,usedInDevice:e.usedInDevices.join(", ")}));return e({summary:n,devices:i,boards:l,parts:s.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.totalQuantity,unitPrice:e.unitPrice,totalPrice:e.totalCost,usedIn:e.usedInBoards.join(", ")}))},"سفارش_دستگاه‌ها_".concat(n.orderNumber,".xlsx"))},[e]);return{exportToExcel:e,exportPartsOrder:t,exportBoardsOrder:a,exportDevicesOrder:n}}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,342,248,441,684,358],()=>t(3340)),_N_E=e.O()}]);