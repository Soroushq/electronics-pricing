(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[885],{2383:()=>{},3625:(e,t,a)=>{Promise.resolve().then(a.bind(a,5163))},3686:()=>{},3741:(e,t,a)=>{"use strict";a.d(t,{$n:()=>i});var r=a(5155);a(2115);var s=a(7050);let i=e=>{let{children:t,className:a,variant:i="primary",size:n="md",loading:l=!1,icon:c,iconPosition:o="right",fullWidth:d=!1,disabled:u,...m}=e,h=u||l;return(0,r.jsxs)("button",{className:(0,s.cn)("btn-base inline-flex items-center justify-center gap-2 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"btn-primary focus:ring-blue-500",secondary:"btn-secondary focus:ring-gray-500",success:"btn-success focus:ring-green-500",danger:"btn-danger focus:ring-red-500",warning:"bg-yellow-500 hover:bg-yellow-600 text-white focus:ring-yellow-500",outline:"btn-outline focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 text-gray-700 border-transparent focus:ring-gray-500"}[i],{sm:"btn-sm text-sm",md:"btn-md text-sm",lg:"btn-lg text-base",xl:"px-6 py-3 text-lg"}[n],d&&"w-full",a),disabled:h,...m,children:[l&&(0,r.jsx)("div",{className:"spinner"}),!l&&c&&"right"===o&&(0,r.jsx)("span",{className:"flex-shrink-0",children:c}),t&&(0,r.jsx)("span",{className:(0,s.cn)(l&&"opacity-0","font-persian"),children:t}),!l&&c&&"left"===o&&(0,r.jsx)("span",{className:"flex-shrink-0",children:c})]})}},5163:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115),i=a(5695),n=a(3654),l=a(3741),c=a(7703),o=a(6226),d=a(6728);function u(){let e=(0,i.useRouter)(),{exportPartsOrder:t}=(0,d.L)(),[a,u]=(0,s.useState)([]),[m,h]=(0,s.useState)("all"),[x,p]=(0,s.useState)(""),g=[{id:"1",name:"مقاومت ۱۰کΩ",partNumber:"R-10K-01",currentPrice:500,categoryId:"resistors",unitId:"pcs",stockQuantity:1500,minStockLevel:100,supplierId:"supplier1",specifications:[{name:"مقاومت",value:"10kΩ",unit:"Ω"},{name:"توان",value:"0.25W",unit:"W"}],images:[],alternativeParts:[],tags:[],currency:"IRR",isActive:!0,isObsolete:!1,createdAt:new Date,updatedAt:new Date},{id:"2",name:"خازن ۱۰۰μF",partNumber:"C-100UF-16V",currentPrice:2e3,categoryId:"capacitors",unitId:"pcs",stockQuantity:800,minStockLevel:50,supplierId:"supplier2",specifications:[{name:"ظرفیت",value:"100μF",unit:"F"},{name:"ولتاژ",value:"16V",unit:"V"}],images:[],alternativeParts:[],tags:[],currency:"IRR",isActive:!0,isObsolete:!1,createdAt:new Date,updatedAt:new Date},{id:"3",name:"IC LM358",partNumber:"IC-LM358-DIP8",currentPrice:8e3,categoryId:"ics",unitId:"pcs",stockQuantity:200,minStockLevel:20,supplierId:"supplier1",specifications:[{name:"نوع",value:"Op-Amp",unit:""},{name:"پکیج",value:"DIP-8",unit:""}],images:[],alternativeParts:[],tags:[],currency:"IRR",isActive:!0,isObsolete:!1,createdAt:new Date,updatedAt:new Date},{id:"4",name:"ترانزیستور BC547",partNumber:"TR-BC547",currentPrice:1500,categoryId:"transistors",unitId:"pcs",stockQuantity:500,minStockLevel:50,supplierId:"supplier2",specifications:[{name:"نوع",value:"NPN",unit:""},{name:"جریان کلکتور",value:"100mA",unit:"A"}],images:[],alternativeParts:[],tags:[],currency:"IRR",isActive:!0,isObsolete:!1,createdAt:new Date,updatedAt:new Date},{id:"5",name:"دیود 1N4007",partNumber:"D-1N4007",currentPrice:800,categoryId:"diodes",unitId:"pcs",stockQuantity:1e3,minStockLevel:100,supplierId:"supplier1",specifications:[{name:"ولتاژ معکوس",value:"1000V",unit:"V"},{name:"جریان مستقیم",value:"1A",unit:"A"}],images:[],alternativeParts:[],tags:[],currency:"IRR",isActive:!0,isObsolete:!1,createdAt:new Date,updatedAt:new Date}],f=(e,t)=>{let r=a.find(t=>t.partId===e.id);if(r)j(e.id,r.quantity+t);else{let a={partId:e.id,name:e.name,partNumber:e.partNumber,unitPrice:e.currentPrice,quantity:t,totalPrice:e.currentPrice*t,category:e.categoryId};u(e=>[...e,a])}},j=(e,t)=>{if(t<=0)return void b(e);u(a=>a.map(a=>a.partId===e?{...a,quantity:t,totalPrice:a.unitPrice*t}:a))},b=e=>{u(t=>t.filter(t=>t.partId!==e))},v=()=>a.reduce((e,t)=>e+t.quantity,0),y=g.filter(e=>{let t="all"===m||e.categoryId===m,a=!x||e.name.toLowerCase().includes(x.toLowerCase())||e.partNumber.toLowerCase().includes(x.toLowerCase());return t&&a});return(0,r.jsx)(o.e,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(l.$n,{variant:"outline",onClick:()=>e.back(),className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,r.jsx)(n.Ef,{children:"بازگشت"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:(0,r.jsx)(n.Ef,{children:"سفارش قطعات"})}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:(0,r.jsx)(n.Ef,{children:"انتخاب و سفارش قطعات مورد نیاز"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(l.$n,{variant:"secondary",onClick:()=>{if(0===a.length)return void alert("سبد خرید خالی است! ابتدا قطعاتی اضافه کنید.");t(a)?alert("فایل اکسل با موفقیت ایجاد شد!"):alert("خطا در ایجاد فایل اکسل!")},disabled:0===a.length,className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)(n.Ef,{children:"خروجی اکسل"})]}),(0,r.jsx)(l.$n,{variant:"outline",onClick:()=>u([]),children:(0,r.jsx)(n.Ef,{children:"پاک کردن سبد"})}),(0,r.jsx)(l.$n,{variant:"primary",onClick:()=>{if(0===a.length)return void alert("لطفاً حداقل یک قطعه به سفارش اضافه کنید");console.log("Submitting order:",a),alert("سفارش ".concat(a.length," نوع قطعه با موفقیت ثبت شد!")),u([])},children:(0,r.jsx)(n.Ef,{children:"ثبت سفارش"})})]})]})}),(0,r.jsxs)("div",{className:"flex h-[calc(100vh-120px)]",children:[(0,r.jsxs)("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"font-semibold text-gray-900 mb-3",children:(0,r.jsx)(n.Ef,{children:"قطعات موجود"})}),(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("input",{type:"text",placeholder:"جستجو در قطعات...",value:x,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})}),(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"همه دسته‌ها"}),(0,r.jsx)("option",{value:"resistors",children:"مقاومت‌ها"}),(0,r.jsx)("option",{value:"capacitors",children:"خازن‌ها"}),(0,r.jsx)("option",{value:"ics",children:"آی‌سی‌ها"}),(0,r.jsx)("option",{value:"transistors",children:"ترانزیستورها"}),(0,r.jsx)("option",{value:"diodes",children:"دیودها"})]})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:y.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 hover:shadow-sm transition-shadow",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 text-sm",children:(0,r.jsx)(n.Ef,{children:e.name})}),(0,r.jsx)("p",{className:"text-xs text-gray-600 font-mono",children:e.partNumber})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:(0,r.jsxs)(n.Ef,{children:["موجودی: ",e.stockQuantity.toLocaleString("fa-IR")]})}),(0,r.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsx)("span",{className:"text-xs font-semibold text-green-600",children:(0,r.jsxs)(n.Ef,{children:[e.currentPrice.toLocaleString("fa-IR")," ریال"]})})}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>f(e,1),children:(0,r.jsx)(n.Ef,{children:"+۱"})}),(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>f(e,5),children:(0,r.jsx)(n.Ef,{children:"+۵"})}),(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>f(e,10),children:(0,r.jsx)(n.Ef,{children:"+۱۰"})})]})]},e.id))})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col bg-gray-50",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:(0,r.jsxs)(n.Ef,{children:["سبد خرید (",a.length," نوع قطعه)"]})}),a.length>0&&(0,r.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-blue-600 font-medium",children:(0,r.jsx)(n.Ef,{children:"تعداد انواع:"})}),(0,r.jsx)("p",{className:"font-bold text-blue-800",children:(0,r.jsxs)(n.Ef,{children:[a.length.toLocaleString("fa-IR")," نوع"]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-blue-600 font-medium",children:(0,r.jsx)(n.Ef,{children:"مجموع تعداد:"})}),(0,r.jsx)("p",{className:"font-bold text-blue-800",children:(0,r.jsxs)(n.Ef,{children:[v().toLocaleString("fa-IR")," عدد"]})})]})]})}),0===a.length?(0,r.jsxs)(c.Zp,{className:"p-8 text-center",children:[(0,r.jsx)("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:(0,r.jsx)(n.Ef,{children:"سبد خرید خالی است"})}),(0,r.jsx)("p",{className:"text-gray-600",children:(0,r.jsx)(n.Ef,{children:"از سایدبار سمت چپ قطعات مورد نیاز را انتخاب کنید"})})]}):(0,r.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,r.jsx)(c.Zp,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:(0,r.jsx)(n.Ef,{children:e.name})}),(0,r.jsx)("p",{className:"text-sm text-gray-600 font-mono",children:e.partNumber}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:(0,r.jsxs)(n.Ef,{children:[e.unitPrice.toLocaleString("fa-IR")," ریال/عدد"]})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>j(e.partId,e.quantity-1),children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,r.jsx)("span",{className:"w-16 text-center font-medium",children:(0,r.jsx)(n.Ef,{children:e.quantity.toLocaleString("fa-IR")})}),(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>j(e.partId,e.quantity+1),children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),(0,r.jsx)("div",{className:"text-left w-28",children:(0,r.jsx)("p",{className:"font-semibold text-green-600",children:(0,r.jsxs)(n.Ef,{children:[e.totalPrice.toLocaleString("fa-IR")," ریال"]})})}),(0,r.jsx)(l.$n,{variant:"outline",size:"sm",onClick:()=>b(e.partId),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})},e.partId))})]})}),(0,r.jsx)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:(0,r.jsx)(n.Ef,{children:"خلاصه سفارش"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:(0,r.jsx)(n.Ef,{children:"تعداد انواع:"})}),(0,r.jsx)("span",{className:"font-medium",children:(0,r.jsxs)(n.Ef,{children:[a.length.toLocaleString("fa-IR")," نوع"]})})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:(0,r.jsx)(n.Ef,{children:"مجموع قطعات:"})}),(0,r.jsx)("span",{className:"font-medium",children:(0,r.jsxs)(n.Ef,{children:[v().toLocaleString("fa-IR")," عدد"]})})]}),(0,r.jsx)("hr",{}),(0,r.jsx)("div",{className:"bg-green-50 rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-semibold text-gray-900",children:(0,r.jsx)(n.Ef,{children:"مجموع کل:"})}),(0,r.jsx)("span",{className:"font-bold text-lg text-green-600",children:(0,r.jsxs)(n.Ef,{children:[a.reduce((e,t)=>e+t.totalPrice,0).toLocaleString("fa-IR")," ریال"]})})]})}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,r.jsx)("p",{children:(0,r.jsx)(n.Ef,{children:"• قیمت‌ها شامل مالیات"})}),(0,r.jsx)("p",{children:(0,r.jsx)(n.Ef,{children:"• هزینه حمل جداگانه محاسبه می‌شود"})}),(0,r.jsx)("p",{children:(0,r.jsx)(n.Ef,{children:"• امکان تغییر قیمت تا زمان تایید نهایی"})})]})]})]})})]})]})})}},6728:(e,t,a)=>{"use strict";a.d(t,{L:()=>i});var r=a(2115),s=a(3925);let i=()=>{let e=(0,r.useCallback)((e,t)=>{try{let a=s.Wp.book_new(),r=[["گزارش سفارش الکترونیک","","",""],["","","",""],["شماره سفارش",e.summary.orderNumber,"",""],["تاریخ سفارش",e.summary.orderDate,"",""],["نام مشتری",e.summary.customerName||"نامشخص","",""],["","","",""],["خلاصه سفارش","","",""],["انواع دستگاه",e.summary.totalUniqueDevices,"مجموع دستگاه‌ها",e.summary.totalDevices],["انواع برد",e.summary.totalUniqueBoards,"مجموع بردها",e.summary.totalBoards],["انواع قطعه",e.summary.totalUniqueParts,"مجموع قطعات",e.summary.totalParts],["","","",""],["مبلغ کل (ریال)",e.summary.grandTotal.toLocaleString("fa-IR"),"",""]],i=s.Wp.aoa_to_sheet(r);if(i["!cols"]=[{width:20},{width:20},{width:20},{width:20}],s.Wp.book_append_sheet(a,i,"خلاصه سفارش"),e.devices&&e.devices.length>0){let t=e.devices.map(e=>[e.deviceCode,e.deviceName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.boardsCount,e.partsCount]),r=e.devices.reduce((e,t)=>e+t.totalPrice,0);t.push(["","مجموع کل","","",r.toLocaleString("fa-IR"),"",""]);let i=[["کد دستگاه","نام دستگاه","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","تعداد بردها","تعداد قطعات"],...t],n=s.Wp.aoa_to_sheet(i);n["!cols"]=[{width:15},{width:25},{width:10},{width:18},{width:18},{width:12},{width:12}],s.Wp.book_append_sheet(a,n,"لیست دستگاه‌ها")}if(e.boards&&e.boards.length>0){let t=e.boards.map(e=>[e.boardCode,e.boardName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.partsCount,e.usedInDevice||""]),r=e.boards.reduce((e,t)=>e+t.totalPrice,0);t.push(["","مجموع کل","","",r.toLocaleString("fa-IR"),"",""]);let i=[["کد برد","نام برد","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","تعداد قطعات","استفاده در"],...t],n=s.Wp.aoa_to_sheet(i);n["!cols"]=[{width:15},{width:25},{width:10},{width:18},{width:18},{width:12},{width:20}],s.Wp.book_append_sheet(a,n,"لیست بردها")}let n=e.parts.map(e=>[e.partCode,e.partName,e.quantity,e.unitPrice.toLocaleString("fa-IR"),e.totalPrice.toLocaleString("fa-IR"),e.category||"",e.supplier||"",e.usedIn||""]),l=e.parts.reduce((e,t)=>e+t.totalPrice,0),c=e.parts.reduce((e,t)=>e+t.quantity,0);n.push(["","مجموع کل",c,"",l.toLocaleString("fa-IR"),"","",""]);let o=[["کد قطعه","نام قطعه","تعداد","قیمت واحد (ریال)","قیمت کل (ریال)","دسته‌بندی","تامین‌کننده","استفاده در"],...n],d=s.Wp.aoa_to_sheet(o);d["!cols"]=[{width:15},{width:30},{width:10},{width:18},{width:18},{width:15},{width:15},{width:25}],s.Wp.book_append_sheet(a,d,"لیست قطعات");let u=t||"سفارش_".concat(e.summary.orderNumber,"_").concat(new Date().toLocaleDateString("fa-IR").replace(/\//g,"-"),".xlsx");return s._h(a,u),!0}catch(e){return console.error("خطا در تولید فایل اکسل:",e),!1}},[]),t=(0,r.useCallback)((t,a)=>{let r={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:a||"P-".concat(Date.now()),totalDevices:0,totalBoards:0,totalParts:t.reduce((e,t)=>e+t.quantity,0),totalUniqueDevices:0,totalUniqueBoards:0,totalUniqueParts:t.length,grandTotal:t.reduce((e,t)=>e+t.totalPrice,0)};return e({summary:r,parts:t.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,category:e.category,usedIn:"سفارش مستقل قطعات"}))},"سفارش_قطعات_".concat(r.orderNumber,".xlsx"))},[e]),a=(0,r.useCallback)((t,a,r)=>{let s={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:r||"B-".concat(Date.now()),totalDevices:0,totalBoards:t.reduce((e,t)=>e+t.quantity,0),totalParts:a.reduce((e,t)=>e+t.totalQuantity,0),totalUniqueDevices:0,totalUniqueBoards:t.length,totalUniqueParts:a.length,grandTotal:t.reduce((e,t)=>e+t.totalCost,0)},i=t.map(e=>({boardCode:"BRD-".concat(e.boardId),boardName:e.name,quantity:e.quantity,unitPrice:e.unitCost,totalPrice:e.totalCost,partsCount:e.parts.length,usedInDevice:"سفارش مستقل برد"}));return e({summary:s,boards:i,parts:a.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.totalQuantity,unitPrice:e.unitPrice,totalPrice:e.totalCost,usedIn:e.usedInBoards.join(", ")}))},"سفارش_بردها_".concat(s.orderNumber,".xlsx"))},[e]),i=(0,r.useCallback)((t,a,r,s)=>{let i={orderDate:new Date().toLocaleDateString("fa-IR"),orderNumber:s||"D-".concat(Date.now()),totalDevices:t.reduce((e,t)=>e+t.quantity,0),totalBoards:a.reduce((e,t)=>e+t.totalQuantity,0),totalParts:r.reduce((e,t)=>e+t.totalQuantity,0),totalUniqueDevices:t.length,totalUniqueBoards:a.length,totalUniqueParts:r.length,grandTotal:t.reduce((e,t)=>e+t.totalCost,0)},n=t.map(e=>({deviceCode:"DEV-".concat(e.deviceId),deviceName:e.name,quantity:e.quantity,unitPrice:e.unitCost,totalPrice:e.totalCost,boardsCount:e.boards.length,partsCount:e.boards.reduce((e,t)=>e+t.parts.length,0)})),l=a.map(e=>({boardCode:"BRD-".concat(e.boardId),boardName:e.name,quantity:e.totalQuantity,unitPrice:e.unitCost,totalPrice:e.totalCost,partsCount:0,usedInDevice:e.usedInDevices.join(", ")}));return e({summary:i,devices:n,boards:l,parts:r.map(e=>({partCode:e.partNumber,partName:e.name,quantity:e.totalQuantity,unitPrice:e.unitPrice,totalPrice:e.totalCost,usedIn:e.usedInBoards.join(", ")}))},"سفارش_دستگاه‌ها_".concat(i.orderNumber,".xlsx"))},[e]);return{exportToExcel:e,exportPartsOrder:t,exportBoardsOrder:a,exportDevicesOrder:i}}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,342,248,441,684,358],()=>t(3625)),_N_E=e.O()}]);